O PostgreSQL (também conhecido como Postgres) é um sistema de gerenciamento de banco de dados relacional de código aberto, conhecido por sua robustez, escalabilidade e capacidade de lidar com grandes volumes de dados. Sua arquitetura é projetada para oferecer alta performance e confiabilidade. Vamos explorar os principais componentes da arquitetura do PostgreSQL:

1. **Processos do PostgreSQL**:

   - **Postmaster**: É o processo principal que coordena a interação entre os clientes e o servidor de banco de dados. Ele gerencia a criação de novos processos para lidar com as conexões dos clientes.

   - **Processos de Backend**: Cada conexão de cliente é atendida por um processo de backend dedicado. Esses processos executam as consultas e transações solicitadas pelos clientes.

2. **Sistema de Armazenamento**:

   - **Arquivos de Dados**: O PostgreSQL armazena dados em arquivos no sistema de arquivos. Existem diferentes tipos de arquivos, como os de dados, índices e registros de transações.

   - **Buffer Cache**: O PostgreSQL mantém um cache de buffers em memória para reduzir a necessidade de acessos frequentes ao disco. Isso ajuda a melhorar o desempenho, pois muitas operações podem ser realizadas diretamente na memória.

3. **Gestão de Transações**:

   - **Controlador de Transações (Transaction Manager)**: Gerencia transações, garantindo que as operações sejam realizadas de forma consistente e que as propriedades ACID (Atomicidade, Consistência, Isolamento, Durabilidade) sejam mantidas.

4. **Otimizador de Consultas**:

   - **Planner**: É responsável por criar o plano de execução otimizado para as consultas. Ele decide a melhor maneira de recuperar os dados com base na estrutura do banco de dados e nas estatísticas disponíveis.

5. **Módulos de Funcionalidades Adicionais**:

   - **Extensões**: O PostgreSQL oferece um sistema de extensões que permite adicionar funcionalidades extras ao banco de dados, como linguagens de programação, tipos de dados personalizados, entre outros.

6. **Gerenciamento de Concorrência**:

   - **MVCC (Multi-Version Concurrency Control)**: O PostgreSQL utiliza o MVCC para permitir que várias transações ocorram simultaneamente sem interferir umas nas outras. Isso é fundamental para garantir a consistência dos dados em ambientes com múltiplos usuários.

7. **Gestão de Segurança**:

   - **Sistema de Autenticação e Autorização**: O PostgreSQL oferece um sistema robusto de autenticação e autorização para garantir que apenas usuários autorizados tenham acesso aos dados e operações permitidas.

8. **Recuperação de Falhas**:

   - **WAL (Write-Ahead Logging)**: O PostgreSQL utiliza uma técnica de log chamada Write-Ahead Logging para garantir a durabilidade dos dados em caso de falha. Isso significa que as alterações são registradas em um log antes de serem aplicadas aos dados no disco.

Esses são alguns dos principais componentes que compõem a arquitetura do PostgreSQL. É importante notar que o PostgreSQL é altamente configurável e oferece uma ampla gama de opções de configuração para atender às necessidades específicas de diferentes ambientes e aplicações.


-------------------------------------------------------------------------------

iremos aprender o que é postgres e sua arquitetura. 
- Introdução: O que é postgre e por que é tão famoso durante um período de tempo
este é um dos sgbds mais utilizados hoje em dia. Uma das características mais importantes do postgres é que ele é um banco de dados relacional de código aberto de classe empresarial. 
Ele suporta sql, que é uma linguagem de consulta estruturada, e json, ambos formatos para consulta. Está a mais de 20 anos em desenvolvimento na comunidade. sobre o uso, pode ser usado para data warehouse, aplicação geoespacial e análise de dados, por exemplo. ele suporta qualquer tipo de dado e é adequado para tipos avançados de dados. 
Sobre os recursos, ele possui a arquitetura MVCC (Cortrole de Simultaneidade Multi Versão), ou seja, o Postgres utiliza esse recurso para permitir que várias transações ocorram simultaneamente sem interferir umas nas outras. Mas, na verdade, esse recurso não existe apenas no postgres, ele está embutido em todos os outros bancos de dados relacionais, como o Oracle por exemplo. Mas a diferença é que o postgres é livre de custos e é open source. 
Tem tambem o controle de acesso granular, que permite que os administradores controlem quem pode acessar quais recursos do banco de dados e quais operações podem ser executadas, ou seja, você pode dar acesso a dados específicos, ou acesso as visualizações das tabelas, entre outras possibilidades. 
Tem também o conceito de espaços de tabelas que não sejam o padrão que podem ser criados, um espaço de tabela separado que pode conter todos os dados.
há um recurso de replicação assíncrona que é um método de replicação de dados que permite que os dados sejam escritos no servidor primário e depois copiados para o servidor secundário
os recursos de backup no postgre são: dump SQL, backup em nível de sistema de arquivos e arquivamento contínuo. O dump SQL é uma cópia dos dados em formato SQL . O utilitário pg_dump pode ser usado para criar um dump SQL. O backup em nível de sistema de arquivos é uma cópia dos arquivos do banco de dados. O backup em nível de sistema de arquivos é útil quando você precisa fazer backup de grandes quantidades de dados e a latência não é uma preocupação crítica. O arquivamento contínuo é um método de backup que permite que os dados sejam escritos no servidor primário e depois copiados para o servidor secundário.
E tem suporte para o conjunto de caracteres internacionais. 

- Licenciamento: 

licenciamento isso está sempre incomodando o
organizações se você falar sobre o
famoso rd bms
você paga o custo em termos de
curso que você vai usar vamos
diga, fale sobre o oráculo, então você tem
pagar muito, muito custo de licença
e se você estiver falando sobre o
postgre não há custo de licença
e ah
mais se você for usá-lo em um
calcule onde uh o número de códigos de CPU
são mais do que sempre tememos pagar
mais uh custo custo de licença para o
uh, para o uh proprietário, esse é o uh
a organização
do qual compramos, digamos
a corporação oráculo
uh
e no caso deste uh postgre que se
isso é
fontes abertas quem irá apoiá-lo
então há uma equipe dedicada de
colaboradores e aqueles que continuamente
funciona e se houver algum bug
eles são
fixo e
e as novas versões são lançadas ao longo de um
período de tempo, então o licenciamento é
código aberto e você tem o código
você pode usá-lo e
você pode usá-lo da maneira que quiser
para

arquitetura

Vamos falar sobre a arquitetura do postgre. É um modelo servidor cliente, ou seja, o cliente envia uma solicitação para o postgres então temos algo chamado de parâmetros de memória, memória no centro e
os processos em segundo plano. Então o processo principal quando o servidor inicia o postmaster (processo principal que coordena a interação entre os clientes e o servidor de banco de dados. Ele gerencia a criação de novos processos para lidar com as conexões dos clientes)
então quando há uma solicitação do cliente vai diretamente para o postmaster. O postmaster irá verificar se tem todas as permissões necessárias para fazer login no banco de dados. Se passar disso então há um processo de postgrade gerado e, em seguida, o
o trabalho real começa. Então digamos que um instrução select foi disparada e que é armazenado no arquivo de dados, então primeiro
todos esses valores vêm para o burffer compartilhado e o postgre vai ler dali e então o valor é retornado de volta ao cliente.Então o aplicativo se conecta ao processo postmaster, o postmaster verifica o aplicativo corretamente, e se for bem sucedido, ele conecta o aplicativo cliente.
a instância não escreve ou lê o aplicativo diretamente ao arquivos de dados, mas coloca no buffer compartilhado e o processo postgres atua no buffer compartilhado e nos wal buffers (digamos que alguma modificação de dados ocorreu então esta area específica do buffer vai estar suja então usando o processo em segundo plano do write ahead log retorna para os walfilles, que são como arquivos de log pra onde toda a informação retorna e é armazenada permanentemente)
então é isso é incrível em
termos de
o tipo de trabalho que ele faz, então há um
verifique também o processo de ponteiro que
o que faz o que verifica os pontos de verificação e
em um determinado momento, seu
o banco de dados estará em modo consistente, então
que
os dados nos arquivos de dados e na memória, uh
que isso será liberado para os dados uh
arquivos
então isso é apenas um básico, então nós
então temos a área de memória que temos
compartilhado antes
onde no valor vermelho dos dados
os arquivos estão lá, então você tem a parede
buffers onde em qualquer dado que seja
o que deveria ser o que foi alterado
tem que ser
entre nesta área e usando a parede
ele é gravado nos arquivos de dados, então você
tem memória de trabalho e trabalho de manutenção
memória
se você ativou o arquivador, então
os arquivos de parede são
movido para os arquivos de parede arquivados
então este é apenas o mesmo diagrama
então temos o processo postmaster que
é o processo principal então temos
uh postgre uh então processe uh
então estes são alguns dos importantes
buffer compartilhado de áreas de memória
trabalho de manutenção de memória de trabalho de buffer de parede
memória e então você tem alguns dos
importante muito importante
escritor de fundo que escreve o
buffer sujo na parede dos arquivos de dados, uh
processo em segundo plano o que ele faz ele escolhe
até o
ah, o
o
o valor alterado dos buffers de parede e
escreva para o
arquivos de parede se você tiver ativado o
arquivando então será finalmente
retornado ao arquivo para todos os arquivos
uh, o próximo é apenas uma descrição
dos diferentes, uh
então quando você começa quando diz systemctl
status
e postgresql
uh, então ele mostra isso para você
processos veremos isso em
na demonstração, então o primeiro processo que
é
gerado depois
depois que o postmaster é o logger, então
o que faz ele grava o log de erros
arquivo para o
arquivo de log
então temos o ponteiro de verificação quando um
ponto de verificação acontece assim
há algum intervalo predefinido quando
onde no ponto de verificação acontece e tudo
o sujo armazena em buffer os dados que foram
alterado, ele é devolvido ao
para os arquivos de dados, então você tem o escritor
escritor de novo, uh, este é o
escritor de fundo que
ele grava periodicamente os buffers sujos
para um arquivo, caso contrário, o ponto de verificação
acontece então você tem a parede ou o escritor
que é um processo em segundo plano que
pega as informações da válvula
buffers e direito ao
bem arquivos, então você tem um dos muito
bom recurso que é chamado de automático
vácuo
lançador e daí é mais ou menos
liberando o espaço não utilizado quando houver
são muitas inserções, atualizações e exclusões
um monte de
o espaço foi liberado
nas tabelas então ele faz um
trabalho de manutenção nisso, então vamos
tenha uma discussão separada sobre isso então
nós temos arquivador então
quando quando você tem a parede
uh ativado então logo em frente
habilitado e
você queria manter toda a transação
bloqueios, então você tem que habilitar isso para que
você pode recuperar seu banco de dados com segurança em
um determinado ponto do tempo
então você tem um coletor de estatísticas
ele lhe dirá sobre o uso da tabela
informações estatísticas, então estes são os
e
os processos em segundo plano que são
responda quando você iniciar seu
instância do postgre
área de memória que você tem
memória compartilhada onde no cache do banco de dados
e o cache do log de transações acontece
então você compartilhou o buffer, então este termo
você pode ver em quase todos os
versões todos os motores do banco de dados
então o que ele faz é minimizar o
disco i o e uh
o que isso coloca coloca tudo maior
tabelas para o
o buffer
e minimiza o tempo de acesso
quando tem que escolher os dados do
arquivo de dados para que ele o coloque no arquivo compartilhado
amortecedor
então você tem os amortecedores de parede
o que faz lá temporariamente
armazena alterações através do banco de dados e
e quando tem que escrever na parede
arquiva o processo de fundo da parede
pega pega da parede
buffers e escrevê-lo na parede é
útil para backup e recuperação, então você
tem o processo postmaster então o que é
o postmaster processa o postmaster
processo é o primeiro processo que é
iniciado quando você inicia seu postgresql
instância e executa a recuperação que
inicializa a área de memória que
executa os processos em segundo plano
e
o último que é o último mas
não menos importante, qual é a sua memória de trabalho
memória de trabalho de manutenção de espaço e
buffers temporários
esses são os diferentes
áreas de memória que são usadas para
Ordenação
então quando você diz espaço de memória de trabalho isso
é usado para
classificação e temporário, uh
operações de bitmap e se juntou para que o
o valor padrão é 4 4 mb e manutenção
memória de trabalho se você tiver o aspirador automático
habilitado então e uh
isso é usado principalmente para o seu
criar índice e aspirar
buffer temporário que é usado para o
tabelas temporárias caso você use o
tabelas temporárias
e
é isso então veremos um pequeno muito
pequena demonstração
o que diz
sistemactl
status
então deixe-me arquivar isso
sistemas
ctl
estado postgresql 12.
então quando você disparar isso você dirá aquilo
o status está em execução e
você verá isso tudo isso
então você tem o ID do processo o pid principal
é um triplo um cinco postmaster
e uh, isso é isso que tínhamos
falado em
na arquitetura este é o primeiro
processo processo em segundo plano que inicia
e então os outros processos são iniciados
registrador
uh, que registra todos os erros
arquivo de mensagem no log de erros, então você tem
o ponteiro de verificação, então você tem
escritor de fundo que escreve
o sujo primeiro depois você tem parede
escritor que coleta as informações
do buffer de parede e escreva na parede
arquivos, então você tem o iniciador automático de vácuo
uh, ele escreve, faz o automático
aspirando, uh, trabalho, uh, como quando você
há um índice claro acontecendo ou quando
tem que liberar o espaço
espaço não utilizado em uma tabela, então você tem
o coletor de estatísticas e então você tem um
iniciador de replicação lógica
então isso é um básico, uh, do
arquitetura do seu
do seu
do seu ambiente postgre
e vamos rapidamente fazer uma recapitulação
O que fizemos
então conversamos sobre a introdução de
ambiente postgre porque isso é assim
famoso então conversamos sobre diferentes
características
nós conversamos sobre, uh
o licenciamento que é de código aberto gratuito
então a história do postgre então a diferença
a arquitetura arquitetura de memória
processos em segundo plano e diferentes
arquivos de dados físicos onde está escrito
e então nós nós
discutido sobre como os dados são transmitidos
quando um cliente solicita as informações
e
a definição de antecedentes diferentes
processos
e áreas de memória
e
a memória de trabalho
componentes relacionados à área uh
e isso é tudo
então nós
verifiquei o
sistemas ctl status postgre sql 12 então
vimos diferentes processos em segundo plano
então vimos
mais uma coisa que você pode ver no ps3
hífen p triplo um cinco então isso mostra
como
qual é o relacionamento então postmaster
é a base
daqui o resto do
processos em segundo plano são gerados e se
você vê um dois sete um corresponde
para o registrador
espero que isso ajude e
obrigado por assistir